<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>MealPrep</title>
  <!-- Material Icon CDN -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/css/materialize.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <!-- Firebase Reference -->
  <script src="https://www.gstatic.com/firebasejs/5.7.3/firebase.js"></script>
  <link rel="stylesheet" href="./assets/css/style.css">
  <style>


    .card-title {
      display: inline-block;
      width: 100%;
      white-space: nowrap;
      overflow: hidden !important;
      text-overflow: ellipsis;
      font-size: 16px !important;
    }

    /* width */
    ::-webkit-scrollbar {
      width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
      background: #888;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }
  </style>
</head>

<body id="hombody">


  <div class="card-panel grey lighten-2 jumbotronStyle">
    <div>
      <h1>Let's get Cooking</h1>
    </div>
  </div>

  <div style="width:90%;margin:0 auto;">

    <ul id="dropdown1" class="dropdown-content">

      <li><a href="#" onclick="menu_click(this)">Breakfast</a></li>
      <li><a href="#" onclick="menu_click(this)">Lunch</a></li>
      <li><a href="#" onclick="menu_click(this)">Dinner</a></li>
      <li><a href="#" onclick="menu_click(this)">Dessert</a></li>

    </ul>

    <ul id="dropdown2" class="dropdown-content">

      <li><a href="#" onclick="menu_click(this)">American</a></li>
      <li><a href="#" onclick="menu_click(this)">Mexican</a></li>
      <li><a href="#" onclick="menu_click(this)">Indian</a></li>
      <li><a href="#" onclick="menu_click(this)">Italian</a></li>
      <li><a href="#" onclick="menu_click(this)">Chinese</a></li>
      <li><a href="#" onclick="menu_click(this)">Japanese</a></li>
      <li><a href="#" onclick="menu_click(this)">French</a></li>

    </ul>


    <ul id="dropdown3" class="dropdown-content">

      <li><a href="#" onclick="menu_click(this)">Meat</a></li>
      <li><a href="#" onclick="menu_click(this)">Fish</a></li>
      <li><a href="#" onclick="menu_click(this)">Vegetables</a></li>

    </ul>



    <!-- Drop Down Menus -->
    <div>

      <a class="dropdown-button btn" href="#!" data-activates="dropdown1">Meal Type
        <i class="material-icons right">arrow_drop_down</i>
      </a>

      <a class="dropdown-button btn" href="#!" data-activates="dropdown2">Cuisine
        <i class="material-icons right">arrow_drop_down</i>
      </a>

      <a class="dropdown-button btn" href="#!" data-activates="dropdown3">Ingredients
        <i class="material-icons right">arrow_drop_down</i>
      </a>

      <a id="linkHome" href="index.html">Meal Prep Home</a>

    </div>

    



    <!-- API -->

    <p class="lead">

      <span style="font-size:20px;padding-right:25px;" id="title">
        No Selected
      </span>

      <a class="btn btn-primary btn-lg" href="#" role="button" id="search_recipe">Search</a>

    </p>

  </div>

  <div style="width:90%;margin:0 auto;background:#ececec;border:1px solid #536e79;">

    <div class="row" style="margin-bottom:auto;">

      <div id="appendDiv">

      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/js/materialize.min.js"></script>

  <script>
    var food = '';
    if (localStorage.getItem('ingredient') != '') {
      food = localStorage.getItem('ingredient');

      var app_id = 'c44e7b73';
      var app_key = 'bdae3c56829cb3bd8fa7ff4ec1ecec55';
      var queryURL = "https://api.edamam.com/search?q=" +

        food + "&app_id=" + app_id + "&app_key=" + app_key;

      // Performing an AJAX request with the queryURL

      $.ajax({

          url: queryURL,
          method: "GET"
        })

        // After data comes back from the request

        .then(function (response) {

          console.log(queryURL);
          console.log(response);

          // storing the data from the AJAX request in the results variable

          var recipeData = response.hits;

          console.log("No of Recipes : " + recipeData.length);

          // Looping through each result item

          $('#appendDiv').empty();

          var html = '';
          

          for (var i = 0; i < recipeData.length; i++) {

            console.log("Inside Recipes : " + recipeData[i].recipe.image);
            html += '<div class="col s3 m3">';
            html += '<div class="card blue-grey darken-1">';
            html += '<div class="card-content white-text">';
            html += '<div class="card-image">';
            html += '<img class="content-image " src="' + recipeData[i].recipe.image + '">';
            html += '<div class="content-overlay">';
            html += '</div>';
            html += '</div>';
            html += '<span class="card-title blue-text text-darken-2"><a href="' + recipeData[i].recipe.url + '" style="color:#fff;">' +
              recipeData[i].recipe.label + '</a></span>';
            html += '<p style="height:170px;overflow-y:auto;" >' + recipeData[i].recipe.ingredientLines + '</p>';
            html += '</div>';
            html += '</div>';
            html += '</div>';
          }
          $('#appendDiv').append(html);
          localStorage.setItem('ingredient', '');
        });



    } else {

    }

    (function ($) {

      $(function () {

        $('.button-collapse').sideNav();
        $('select').material_select();
        $('.dropdown-button').dropdown();

      }); // end of document ready

    })(jQuery); // end of jQuery name space
    var foods = new Array();

    function menu_click(obj) {
      food = $(obj).html();
      foods.push($(obj).html());
      var temp_html = '';
      for (var idx = 0; idx < foods.length; idx++) {
        temp_html += foods[idx];
        temp_html += "     ";
      }
      $('#title').html(temp_html);
    }
    $('#search_recipe').on('click', function () {



      if (food == '') {
        alert('Select Type');
        return;
      }
      console.log(foods);


      var app_id = 'c44e7b73';
      var app_key = 'bdae3c56829cb3bd8fa7ff4ec1ecec55';

      var query_string = '';


      for (var idx = 0; idx < foods.length; idx++) {
        if (idx == 0) {
          query_string += '?q=';
          query_string += foods;

        } else {
          query_string += '&q=';
          query_string += foods[idx];
        }
      }

      if (query_string == '') {
        alert('select type again');
        return;
      }



      var queryURL = "https://api.edamam.com/search" + query_string + "&app_id=" + app_id + "&app_key=" + app_key;

      // Performing an AJAX request with the queryURL

      $.ajax({

          url: queryURL,
          method: "GET"
        })

        // After data comes back from the request

        .then(function (response) {

          console.log(queryURL);
          console.log(response);

          // storing the data from the AJAX request in the results variable

          var recipeData = response.hits;

          console.log("No of Recipes : " + recipeData.length);

          // Looping through each result item

          $('#appendDiv').empty();

          var html = '';

          function lineBreak() {
          var res = str.split(",").join("<br>")
          document.getElementById("demo").innerHTML = res;
          }

          for (var i = 0; i < recipeData.length; i++) {

            console.log("Inside Recipes : " + recipeData[i].recipe.image);
            html += '<div class="col s3 m3">';
            html += '<div class="card blue-grey darken-1">';
            html += '<div class="card-content white-text">';
            html += '<div class="card-image">';
            html += '<img class="content-image " src="' + recipeData[i].recipe.image + '">';
            html += '<div class="content-overlay">';
            html += '</div>';
            html += '</div>';
            html += '<span class="card-title blue-text text-darken-2"><a href="' + recipeData[i].recipe.url + '" style="color:#fff;">' +
              recipeData[i].recipe.label + '</a></span>';
            html += '<p style="height:170px;overflow-y:auto;" id="demo">' + recipeData[i].recipe.ingredientLines + '</p>';
            html += '</div>';
            html += '</div>';
            html += '</div>'; 
          }
          $('#appendDiv').append(html);
          foods = [];

        });

    });
  </script>

</body>

</html>

 